<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
<title>Hammer Design — String Art</title>
<link rel="stylesheet" href="css/app.css"/>
<link rel="icon" href="data:,">
</head>
<body>
<main id="app">
  <section id="screen-1" class="screen" role="region" aria-label="Home">
    <div class="panel">
      <h2>New project</h2>
      <input id="e1-file" type="file" accept="image/*"/>
      <div class="hint">Pick an image to start.</div>
    </div>
    <div class="panel">
      <h2>My projects</h2>
      <ul id="project-list" class="list"></ul>
    </div>
  </section>

  <section id="screen-2" class="screen" role="region" aria-label="Crop">
    <div class="panel">
      <div class="canvas-wrap"><canvas id="crop-canvas" width="600" height="600" aria-label="Crop canvas"></canvas></div>
      <div class="row">
        <label>Zoom <input id="crop-zoom" type="range" min="0.2" max="5" step="0.01" value="1"/></label>
        <label>Rotate <input id="crop-rot" type="range" min="-180" max="180" step="0.1" value="0"/></label>
      </div>
      <div class="btns">
        <button id="crop-reset">Reset</button>
        <button id="crop-confirm" class="primary">Confirm</button>
      </div>
      <div class="hint">Pinch to zoom and drag to position. Circular mask is the final board.</div>
    </div>
  </section>

  <section id="screen-3" class="screen" role="region" aria-label="Generate">
    <div class="panel">
      <div class="row">
        <label>Pins <input id="p-pins" type="number" min="180" max="360" step="1" value="240"/></label>
        <label>Steps <input id="p-steps" type="number" min="1500" max="6000" step="50" value="3000"/></label>
      </div>
      <div class="row">
        <label>Min turn angle (deg) <input id="p-angle" type="number" min="10" max="25" step="1" value="15"/></label>
        <label>Min pin distance <input id="p-mindist" type="number" min="6" max="60" step="1" value="15"/></label>
      </div>
      <div class="row">
        <label>Fade <input id="p-fade" type="number" min="1" max="100" step="1" value="50"/></label>
        <label>Seed <input id="p-seed" type="number" step="1" value="1337"/></label>
      </div>
      <div class="row">
        <label>Thread width (px) <input id="p-width" type="number" min="0.6" max="1.2" step="0.1" value="0.8"/></label>
        <label>Alpha (0–255) <input id="p-alpha" type="number" min="10" max="255" step="1" value="180"/></label>
      </div>
      <div class="row">
        <label>Thread color
          <select id="p-color"><option value="#000000">Black</option><option value="#ffffff">White</option></select>
        </label>
        <label>Board
          <select id="p-board"><option value="white">White</option><option value="black">Black</option></select>
        </label>
      </div>

      <div class="btns">
        <button id="gen-start" class="primary">Generate</button>
        <button id="gen-pause">Pause</button>
        <button id="gen-resume">Resume</button>
        <button id="gen-cancel" class="danger">Cancel</button>
      </div>
      <div class="meter"><i id="gen-bar" style="width:0%"></i></div>
      <div id="gen-status" class="tiny">Idle</div>
      <div class="canvas-wrap"><canvas id="render-canvas" width="720" height="720" aria-label="Render preview"></canvas></div>
    </div>
  </section>

  <section id="screen-4" class="screen" role="region" aria-label="Steps">
    <div class="panel">
      <div class="e4-board-wrap">
        <div class="e4-toolbar">
          <button id="exp-png" class="good icon-btn">
            <svg aria-hidden="true" viewBox="0 0 32 32" focusable="false">
              <g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M16 5v11"/>
                <path d="m12.5 12.5 3.5 3.5 3.5-3.5"/>
                <path d="M7 17v6a3 3 0 0 0 3 3h12a3 3 0 0 0 3-3v-6"/>
                <path d="M11 23h10"/>
              </g>
              <rect x="5" y="5" width="14" height="9" rx="2.5" fill="currentColor" opacity="0.12" stroke="currentColor" stroke-width="1.5"/>
              <text x="12" y="9.5" text-anchor="middle" dominant-baseline="middle" font-size="4.4" font-weight="700" font-family="inherit" fill="currentColor">PNG</text>
            </svg>
            <span class="sr-only">Export PNG</span>
          </button>
          <button id="exp-svg" class="icon-btn">
            <svg aria-hidden="true" viewBox="0 0 32 32" focusable="false">
              <g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M16 5v11"/>
                <path d="m12.5 12.5 3.5 3.5 3.5-3.5"/>
                <path d="M7 17v6a3 3 0 0 0 3 3h12a3 3 0 0 0 3-3v-6"/>
                <path d="M11 23h10"/>
              </g>
              <rect x="5" y="5" width="14" height="9" rx="2.5" fill="currentColor" opacity="0.12" stroke="currentColor" stroke-width="1.5"/>
              <text x="12" y="9.5" text-anchor="middle" dominant-baseline="middle" font-size="4.4" font-weight="700" font-family="inherit" fill="currentColor">SVG</text>
            </svg>
            <span class="sr-only">Export SVG</span>
          </button>
          <button id="exp-csv" class="icon-btn">
            <svg aria-hidden="true" viewBox="0 0 32 32" focusable="false">
              <g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M16 5v11"/>
                <path d="m12.5 12.5 3.5 3.5 3.5-3.5"/>
                <path d="M7 17v6a3 3 0 0 0 3 3h12a3 3 0 0 0 3-3v-6"/>
                <path d="M11 23h10"/>
              </g>
              <rect x="5" y="5" width="14" height="9" rx="2.5" fill="currentColor" opacity="0.12" stroke="currentColor" stroke-width="1.5"/>
              <text x="12" y="9.5" text-anchor="middle" dominant-baseline="middle" font-size="4.4" font-weight="700" font-family="inherit" fill="currentColor">CSV</text>
            </svg>
            <span class="sr-only">Export CSV</span>
          </button>
          <button id="exp-json" class="icon-btn">
            <svg aria-hidden="true" viewBox="0 0 32 32" focusable="false">
              <g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M16 5v11"/>
                <path d="m12.5 12.5 3.5 3.5 3.5-3.5"/>
                <path d="M7 17v6a3 3 0 0 0 3 3h12a3 3 0 0 0 3-3v-6"/>
                <path d="M11 23h10"/>
              </g>
              <rect x="5" y="5" width="14" height="9" rx="2.5" fill="currentColor" opacity="0.12" stroke="currentColor" stroke-width="1.5"/>
              <text x="12" y="9.5" text-anchor="middle" dominant-baseline="middle" font-size="3.6" font-weight="700" font-family="inherit" fill="currentColor">JSON</text>
            </svg>
            <span class="sr-only">Export JSON</span>
          </button>
        </div>
        <div class="canvas-wrap"><canvas id="viewer-canvas" width="1440" height="1440" aria-label="Viewer"></canvas></div>
      </div>

      <div class="e4-progress">
        <button id="e4-first" class="icon-btn">
          <svg aria-hidden="true" viewBox="0 0 24 24" focusable="false">
            <path d="M7 5v14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
            <path d="M17 19 9 12l8-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
          </svg>
          <span class="sr-only">First step</span>
        </button>
        <div class="e4-progress-center">
          <span id="e4-progress-label">0 / 0</span>
          <div class="e4-progress-bar" role="progressbar" aria-valuemin="0" aria-valuemax="0" aria-valuenow="0">
            <i id="e4-progress-fill" class="e4-progress-fill"></i>
          </div>
        </div>
        <div class="e4-progress-actions">
          <button id="e4-last" class="icon-btn">
            <svg aria-hidden="true" viewBox="0 0 24 24" focusable="false">
              <path d="M17 5v14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
              <path d="m7 5 8 7-8 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
            </svg>
            <span class="sr-only">Last step</span>
          </button>
          <button id="e4-step-jump" class="icon-btn">
            <svg aria-hidden="true" viewBox="0 0 24 24" focusable="false">
              <path d="M5 9h14M5 15h14M9 5v14M15 5v14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
            </svg>
            <span class="sr-only">Jump to step</span>
          </button>
        </div>
      </div>

      <div class="e4-step-cells">
        <div id="e4-prev-pin" class="e4-step-cell e4-cell">
          <span class="e4-step-value" data-value></span>
          <span class="e4-step-placeholder" data-placeholder>—</span>
        </div>
        <div id="e4-current-pin" class="e4-step-cell e4-cell">
          <span class="e4-step-value" data-value></span>
          <span class="e4-step-placeholder" data-placeholder>—</span>
        </div>
        <div id="e4-next-pin" class="e4-step-cell e4-cell">
          <span class="e4-step-value" data-value></span>
          <span class="e4-step-placeholder" data-placeholder>—</span>
        </div>
      </div>

      <div class="e4-controls">
        <div class="e4-speed-control">
          <button id="e4-speed" class="e4-control-speed e4-speed" type="button" aria-haspopup="menu" aria-expanded="false">Speed 3s</button>
          <ul id="e4-speed-menu" class="e4-speed-menu" role="menu" aria-hidden="true"></ul>
        </div>
        <div class="e4-control-group e4-transport">
          <button id="e4-prev" class="icon-btn" type="button">
            <svg aria-hidden="true" viewBox="0 0 24 24" focusable="false">
              <path d="m14 6-6 6 6 6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <span class="sr-only">Previous step</span>
          </button>
          <button id="e4-play" class="icon-btn" type="button" aria-pressed="false">
            <svg aria-hidden="true" viewBox="0 0 24 24" focusable="false" data-state="play">
              <path d="m10 7 8 5-8 5z" fill="currentColor"/>
            </svg>
            <svg aria-hidden="true" viewBox="0 0 24 24" focusable="false" data-state="pause" hidden>
              <g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round">
                <path d="M10 7v10"/>
                <path d="M14 7v10"/>
              </g>
            </svg>
            <span class="sr-only" data-state="play">Play</span>
            <span class="sr-only" data-state="pause" hidden>Pause</span>
          </button>
          <button id="e4-next" class="icon-btn" type="button">
            <svg aria-hidden="true" viewBox="0 0 24 24" focusable="false">
              <path d="m10 6 6 6-6 6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <span class="sr-only">Next step</span>
          </button>
        </div>
        <button id="e4-voice" class="e4-control-voice e4-voice" aria-pressed="false">Voice Off</button>
      </div>
      <div class="tiny">© 2025 Hammer Design</div>
    </div>
  </section>
</main>

<nav class="app-nav" aria-label="Primary">
  <button type="button" data-nav="1" aria-controls="screen-1">
    <svg aria-hidden="true" viewBox="0 0 24 24" focusable="false">
      <path d="M3 10.5 12 3l9 7.5v10.5a1 1 0 0 1-1 1h-5v-6h-6v6H4a1 1 0 0 1-1-1z"/>
    </svg>
    <span class="sr-only">Home</span>
  </button>
  <button type="button" data-nav="2" aria-controls="screen-2">
    <svg aria-hidden="true" viewBox="0 0 24 24" focusable="false">
      <path d="M7 5H5v4M5 15v4h4M17 5h4v4M17 19h4v-4"/>
      <path d="M9 9h6v6H9z"/>
    </svg>
    <span class="sr-only">Crop</span>
  </button>
  <button type="button" data-nav="3" aria-controls="screen-3">
    <svg aria-hidden="true" viewBox="0 0 24 24" focusable="false">
      <path d="M12 4v4m0 8v4m8-8h-4m-8 0H4m13.07-7.07-2.83 2.83m0 6.48 2.83 2.83M6.93 6.93l2.83 2.83m0 6.48-2.83 2.83"/>
    </svg>
    <span class="sr-only">Generate</span>
  </button>
  <button type="button" data-nav="4" aria-controls="screen-4">
    <svg aria-hidden="true" viewBox="0 0 24 24" focusable="false">
      <path d="M9 7h10M9 12h10M9 17h10"/>
      <circle cx="5" cy="7" r="1.5"/>
      <circle cx="5" cy="12" r="1.5"/>
      <circle cx="5" cy="17" r="1.5"/>
    </svg>
    <span class="sr-only">Steps</span>
  </button>
</nav>

<script type="module">
  import * as State from './js/state.js';
  import * as UI from './js/ui.js';
  import './js/i18n.js';
  UI.mount();
  State.go(1);
</script>
</body>
</html>
